extends layout

block title
    = page.metadata.title + " | " + locals.title

block localVars
    - bodyClass = "portfolio"


block content
    include mixins


    - var projects = _.chain(contents.portfolio._.directories).map(function (item) {
    -         var obj = (item["index.md"] || item["index.json"]);
    -         if (obj && obj.metadata && !obj.metadata.template) {
    -             // strip out the pages with no template specified
    -             obj = null;
    -         }
    -         return obj;
    -     }).compact().filter(function(item) {
    -         if (page.metadata.tags) {
    -             var overlap = _.intersection(page.metadata.tags, item.metadata.tags);
    -             return !!overlap.length;
    -         }
    -         return true;
    -     }).sortBy(function (descr) {
    -         var dateStr = descr.metadata.date.toString();
    -         var startDate = parseInt(dateStr.split("--")[0], 10);
    -         var endDate = parseInt(dateStr.split("--")[1], 10) || 0;
    -         return -1 * (startDate + (endDate*.00001));
    -     }).value();


    .row
        .columns.listing
            .large-12
                .breadcrumbs
                    span portfolio
                        - var tag = "";
                        - if (page.metadata.tags) {
                        -   tag = ": " + page.metadata.tags.join(", ");
                        - }
                        != tag

                
            each proj in projects
                .large-12.project-preview
                    +projectPreview(proj)
